!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).Xjs=t()}(this,(function(){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */function e(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))}var t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),n=new Uint8Array(16);function r(){if(!t)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return t(n)}var i=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function o(e){return"string"==typeof e&&i.test(e)}for(var s,a,l,c=[],u=0;u<256;++u)c.push((u+256).toString(16).substr(1));function d(e,t,n){var i=(e=e||{}).random||(e.rng||r)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){n=n||0;for(var s=0;s<16;++s)t[n+s]=i[s];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(c[e[t+0]]+c[e[t+1]]+c[e[t+2]]+c[e[t+3]]+"-"+c[e[t+4]]+c[e[t+5]]+"-"+c[e[t+6]]+c[e[t+7]]+"-"+c[e[t+8]]+c[e[t+9]]+"-"+c[e[t+10]]+c[e[t+11]]+c[e[t+12]]+c[e[t+13]]+c[e[t+14]]+c[e[t+15]]).toLowerCase();if(!o(n))throw TypeError("Stringified UUID is invalid");return n}(i)}class f{}f.isSourcePlugin="undefined"!=typeof window&&window.external&&void 0!==window.external.GetConfiguration,f.isSourceProps="undefined"!=typeof window&&window.external&&void 0===window.external.GetConfiguration&&void 0!==window.external.GetViewId&&void 0!==window.external.GetViewId(),f.isExtension="undefined"!=typeof window&&window.external&&void 0===window.external.GetConfiguration&&void 0!==window.external.GetViewId&&void 0===window.external.GetViewId(),function(e){e.Local="local",e.Remote="remote",e.Proxy="proxy"}(s||(s={})),function(e){e.Extension="extension",e.Source="source",e.Shell="shell,"}(a||(a={})),function(e){e.None="none",e.Warning="warning",e.Debug="debug"}(l||(l={}));var h,p=new class{constructor(){this._asyncId=0,this._callbacks={}}getAsyncId(){return this._asyncId++}register(e,t){return new Promise((n,r)=>{const i=this.getAsyncId();t(Object.assign({asyncId:i},e));const o=setTimeout(()=>{delete this._callbacks[i],r(new Error(e.fn+" failed. Timeout error"))},6e4);this._callbacks[i]={callback:n,clean:()=>{clearTimeout(o),delete this._callbacks[i]}}})}isCallbackExisting(e){return this._callbacks.hasOwnProperty(e)}runCallback({asyncId:e,result:t}){if(this.isCallbackExisting(e)){const{callback:n,clean:r}=this._callbacks[e];n(t),r()}}};!function(e){e.ON="subscribe",e.OFF="unsubscribe"}(h||(h={}));var g="object"==typeof global&&global&&global.Object===Object&&global,y="object"==typeof self&&self&&self.Object===Object&&self,v=g||y||Function("return this")(),m=v.Symbol,b=Object.prototype,w=b.hasOwnProperty,x=b.toString,A=m?m.toStringTag:void 0;var P=Object.prototype.toString;var N=m?m.toStringTag:void 0;function O(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":N&&N in Object(e)?function(e){var t=w.call(e,A),n=e[A];try{e[A]=void 0;var r=!0}catch(e){}var i=x.call(e);return r&&(t?e[A]=n:delete e[A]),i}(e):function(e){return P.call(e)}(e)}var C=Array.isArray;function j(e){return null!=e&&"object"==typeof e}const T=e=>function(e){return"string"==typeof e||!C(e)&&j(e)&&"[object String]"==O(e)}(e)?JSON.parse(e):e;function k(e){return"symbol"==typeof e||j(e)&&"[object Symbol]"==O(e)}var S=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,E=/^\w*$/;function I(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function _(e){if(!I(e))return!1;var t=O(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}var V,F=v["__core-js_shared__"],M=(V=/[^.]+$/.exec(F&&F.keys&&F.keys.IE_PROTO||""))?"Symbol(src)_1."+V:"";var D=Function.prototype.toString;var R=/^\[object .+?Constructor\]$/,$=Function.prototype,G=Object.prototype,L=$.toString,B=G.hasOwnProperty,J=RegExp("^"+L.call(B).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function z(e){return!(!I(e)||(t=e,M&&M in t))&&(_(e)?J:R).test(function(e){if(null!=e){try{return D.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e));var t}function U(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return z(n)?n:void 0}var X=U(Object,"create");var W=Object.prototype.hasOwnProperty;var q=Object.prototype.hasOwnProperty;function H(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Y(e,t){return e===t||e!=e&&t!=t}function Z(e,t){for(var n=e.length;n--;)if(Y(e[n][0],t))return n;return-1}H.prototype.clear=function(){this.__data__=X?X(null):{},this.size=0},H.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},H.prototype.get=function(e){var t=this.__data__;if(X){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return W.call(t,e)?t[e]:void 0},H.prototype.has=function(e){var t=this.__data__;return X?void 0!==t[e]:q.call(t,e)},H.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=X&&void 0===t?"__lodash_hash_undefined__":t,this};var K=Array.prototype.splice;function Q(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Q.prototype.clear=function(){this.__data__=[],this.size=0},Q.prototype.delete=function(e){var t=this.__data__,n=Z(t,e);return!(n<0)&&(n==t.length-1?t.pop():K.call(t,n,1),--this.size,!0)},Q.prototype.get=function(e){var t=this.__data__,n=Z(t,e);return n<0?void 0:t[n][1]},Q.prototype.has=function(e){return Z(this.__data__,e)>-1},Q.prototype.set=function(e,t){var n=this.__data__,r=Z(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this};var ee=U(v,"Map");function te(e,t){var n,r,i=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof t?"string":"hash"]:i.map}function ne(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}ne.prototype.clear=function(){this.size=0,this.__data__={hash:new H,map:new(ee||Q),string:new H}},ne.prototype.delete=function(e){var t=te(this,e).delete(e);return this.size-=t?1:0,t},ne.prototype.get=function(e){return te(this,e).get(e)},ne.prototype.has=function(e){return te(this,e).has(e)},ne.prototype.set=function(e,t){var n=te(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this};function re(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var s=e.apply(this,r);return n.cache=o.set(i,s)||o,s};return n.cache=new(re.Cache||ne),n}re.Cache=ne;var ie,oe,se,ae=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,le=/\\(\\)?/g,ce=(ie=function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(ae,(function(e,n,r,i){t.push(r?i.replace(le,"$1"):n||e)})),t},oe=re(ie,(function(e){return 500===se.size&&se.clear(),e})),se=oe.cache,oe);var ue=m?m.prototype:void 0,de=ue?ue.toString:void 0;function fe(e){if("string"==typeof e)return e;if(C(e))return function(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}(e,fe)+"";if(k(e))return de?de.call(e):"";var t=e+"";return"0"==t&&1/e==-Infinity?"-0":t}function he(e){return null==e?"":fe(e)}function pe(e,t){return C(e)?e:function(e,t){if(C(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!k(e))||E.test(e)||!S.test(e)||null!=t&&e in Object(t)}(e,t)?[e]:ce(he(e))}function ge(e){if("string"==typeof e||k(e))return e;var t=e+"";return"0"==t&&1/e==-Infinity?"-0":t}function ye(e,t){for(var n=0,r=(t=pe(t,e)).length;null!=e&&n<r;)e=e[ge(t[n++])];return n&&n==r?e:void 0}var ve=function(){try{var e=U(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();var me=Object.prototype.hasOwnProperty;function be(e,t,n){var r=e[t];me.call(e,t)&&Y(r,n)&&(void 0!==n||t in e)||function(e,t,n){"__proto__"==t&&ve?ve(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}(e,t,n)}var we=/^(?:0|[1-9]\d*)$/;function xe(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&we.test(e))&&e>-1&&e%1==0&&e<t}function Ae(e,t,n,r){if(!I(e))return e;for(var i=-1,o=(t=pe(t,e)).length,s=o-1,a=e;null!=a&&++i<o;){var l=ge(t[i]),c=n;if(i!=s){var u=a[l];void 0===(c=r?r(u,l,a):void 0)&&(c=I(u)?u:xe(t[i+1])?[]:{})}be(a,l,c),a=a[l]}return e}function Pe(e,t){return null!=e&&t in Object(e)}function Ne(e){return j(e)&&"[object Arguments]"==O(e)}var Oe=Object.prototype,Ce=Oe.hasOwnProperty,je=Oe.propertyIsEnumerable,Te=Ne(function(){return arguments}())?Ne:function(e){return j(e)&&Ce.call(e,"callee")&&!je.call(e,"callee")};function ke(e,t){return null!=e&&function(e,t,n){for(var r,i=-1,o=(t=pe(t,e)).length,s=!1;++i<o;){var a=ge(t[i]);if(!(s=null!=e&&n(e,a)))break;e=e[a]}return s||++i!=o?s:!!(o=null==e?0:e.length)&&"number"==typeof(r=o)&&r>-1&&r%1==0&&r<=9007199254740991&&xe(a,o)&&(C(e)||Te(e))}(e,t,Pe)}function Se(e,t){return function(e,t,n){for(var r=-1,i=t.length,o={};++r<i;){var s=t[r],a=ye(e,s);n(a,s)&&Ae(o,pe(s,e),a)}return o}(e,t,(function(t,n){return ke(e,n)}))}function Ee(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}var Ie=m?m.isConcatSpreadable:void 0;function _e(e){return C(e)||Te(e)||!!(Ie&&e&&e[Ie])}function Ve(e){return(null==e?0:e.length)?function e(t,n,r,i,o){var s=-1,a=t.length;for(r||(r=_e),o||(o=[]);++s<a;){var l=t[s];n>0&&r(l)?n>1?e(l,n-1,r,i,o):Ee(o,l):i||(o[o.length]=l)}return o}(e,1):[]}function Fe(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}var Me=Math.max;var De=ve?function(e,t){return ve(e,"toString",{configurable:!0,enumerable:!1,value:(n=t,function(){return n}),writable:!0});var n}:function(e){return e},Re=Date.now;var $e=function(e){var t=0,n=0;return function(){var r=Re(),i=16-(r-n);if(n=r,i>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(De);var Ge=function(e){return $e(function(e,t,n){return t=Me(void 0===t?e.length-1:t,0),function(){for(var r=arguments,i=-1,o=Me(r.length-t,0),s=Array(o);++i<o;)s[i]=r[t+i];i=-1;for(var a=Array(t+1);++i<t;)a[i]=r[i];return a[t]=n(s),Fe(e,this,a)}}(e,void 0,Ve),e+"")}((function(e,t){return null==e?{}:Se(e,t)}));const Le="event",Be=e=>e===Le;class Je{constructor({clientId:e,type:t,exec:n}){this.eventCallbacks={},this.proxy={clientEvents:{},getClientEvents:e=>(this.proxy.clientEvents.hasOwnProperty(e)||(this.proxy.clientEvents[e]={}),this.proxy.clientEvents[e]),registerEvent:(e,t,n)=>{this.proxy.getClientEvents(e)[t]=n},unregisterEvent(e,t){if(this.proxy.clientEvents.hasOwnProperty(e)){const n=this.proxy.getClientEvents(e);delete n[t],0===Object.keys(n).length&&delete this.proxy.clientEvents[e]}},emitEvent:(e,t)=>{Object.values(this.proxy.clientEvents).forEach(n=>{n.hasOwnProperty(e)&&n[e](t)})}},this.remote={eventCallbacks:{},registerEvent:(e,t)=>{this.remote.eventCallbacks[e]=t,this.sender({from:s.Remote,clientId:this.clientId,type:"event",action:h.ON,eventName:e})},unregisterEvent:e=>{this.eventCallbacks.hasOwnProperty(e)&&(delete this.eventCallbacks[e],this.sender({from:s.Remote,clientId:this.clientId,type:"event",action:h.OFF,eventName:e}))},emitEvent:(e,t)=>{this.remote.eventCallbacks.hasOwnProperty(e)&&this.remote.eventCallbacks[e](t)}},this.clientId=e,this.type=t,this.exec=n}setSender(e){this.sender=e}send(e){return p.register(e,this.sender)}receiveMessage(e){const t=T(e);if(this.isRemote()){if(Be(t.type)){const{eventName:e,result:n}=t;return void this.remote.emitEvent(e,n)}return p.runCallback(Ge(t,["asyncId","result","from","clientId"]))}if(Be(t.type))return t.action===h.ON?void this.proxy.registerEvent(t.clientId,t.eventName,e=>{this.sender({from:s.Proxy,clientId:t.clientId,type:Le,eventName:t.eventName,result:e})}):void this.proxy.unregisterEvent(t.clientId,t.eventName);this.processRequest(Ge(t,["clientId","asyncId","fn","args"]))}processRequest({clientId:t,asyncId:n,fn:r,args:i}){return e(this,void 0,void 0,(function*(){const e=yield this.exec(r,...i);this.sender({from:s.Proxy,clientId:t,asyncId:n,result:e})}))}isRemote(){return this.type===s.Remote}}const ze=(e,t)=>(...n)=>{e(...n),t&&t(...n)},Ue=e=>{if(I(e)&&0!==Object.keys(e).length)for(const t in e){const n=e[t];window[t]=ze(n,window[t])}};class Xe{constructor(e){this._callbacks={},this.external=window.external,this.type=e,Ue({OnAsyncCallback:(e,...t)=>{if("function"==typeof this._callbacks[e]){const n=t.map(e=>decodeURIComponent(e));this._callbacks[e](...n),delete this._callbacks[e]}}})}setRemote(e){this.remote=e}exec(e,...t){return new Promise((n,r)=>{if(this.isRemote())return this.remote.send({from:s.Remote,clientId:this.remote.clientId,fn:e,args:t}).then(n).catch(r);if(this.external&&void 0!==this.external.isXsplitShell||n(),!window.external[e]||!_(window.external[e]))return void r(new Error(e+" is not a valid external call, or is not supported on the target environment."));const i=window.external[e](...t);if("number"==typeof(o=i)||j(o)&&"[object Number]"==O(o))return this._callbacks[i]=e=>{n(e)},i;var o;n(i)})}isRemote(){return this.type===s.Remote}}class We{constructor(e={type:s.Local}){this.type=s.Local,this.clientId=d(),Object.keys(e).forEach(t=>{this.hasOwnProperty(t)&&(this[t]=e[t])}),this.internal=new Xe(this.type),[s.Remote,s.Proxy].includes(this.type)&&(this.remote=new Je({clientId:this.clientId,type:this.type,exec:this.internal.exec.bind(this.internal)}),this.remote.setSender(e.sendMessage),this.internal.setRemote(this.remote))}setConfigWindow(t){return e(this,void 0,void 0,(function*(){if(!f.isSourcePlugin)throw new Error("can only set configuration for the current item");let e=yield this.internal.exec("GetLocalPropertyAsync","prop:BrowserConfiguration"),n={};return""!==e&&"null"!==e||(e=yield this.internal.exec("GetConfiguration")),n=JSON.parse(e||"{}"),n.configUrl=t,yield this.internal.exec("SetBrowserProperty","Configuration",JSON.stringify(n)),!0}))}isLocal(){return this.type===s.Local}isProxy(){return this.type===s.Proxy}isRemote(){return this.type===s.Remote}}function qe(e,t,n=!1){const r=new RegExp("\\${(\\w+)}","g");let i=r.exec(e),o=e;for(;i;){const[s,a]=i;void 0!==t[a]&&(o=o.replace(s,t[a]),n&&delete t[a]),i=r.exec(e)}return o}We.version="3.0.0-alpha.8";function He(e,t,n){return e.reduce((e,n,r)=>e.then(e=>t(e,n,r)),Promise.resolve(n))}function Ye(e,t){return e(t={exports:{}},t.exports),t.exports}var Ze=Ye((function(e,t){const n=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",r="["+n+"][:A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*",i=new RegExp("^"+r+"$");t.isExist=function(e){return void 0!==e},t.isEmptyObject=function(e){return 0===Object.keys(e).length},t.merge=function(e,t,n){if(t){const r=Object.keys(t),i=r.length;for(let o=0;o<i;o++)e[r[o]]="strict"===n?[t[r[o]]]:t[r[o]]}},t.getValue=function(e){return t.isExist(e)?e:""},t.buildOptions=function(e,t,n){var r={};if(!e)return t;for(let i=0;i<n.length;i++)void 0!==e[n[i]]?r[n[i]]=e[n[i]]:r[n[i]]=t[n[i]];return r},t.isName=function(e){const t=i.exec(e);return!(null==t)},t.getAllMatches=function(e,t){const n=[];let r=t.exec(e);for(;r;){const i=[],o=r.length;for(let e=0;e<o;e++)i.push(r[e]);n.push(i),r=t.exec(e)}return n},t.nameRegexp=r}));Ze.isExist,Ze.isEmptyObject,Ze.merge,Ze.getValue,Ze.buildOptions,Ze.isName,Ze.getAllMatches,Ze.nameRegexp;const Ke=function(e,t){const n={};if(!(e.child&&!Ze.isEmptyObject(e.child)||e.attrsMap&&!Ze.isEmptyObject(e.attrsMap)))return Ze.isExist(e.val)?e.val:"";Ze.isExist(e.val)&&("string"!=typeof e.val||""!==e.val&&e.val!==t.cdataPositionChar)&&("strict"===t.arrayMode?n[t.textNodeName]=[e.val]:n[t.textNodeName]=e.val),Ze.merge(n,e.attrsMap,t.arrayMode);const r=Object.keys(e.child);for(let s=0;s<r.length;s++){var i=r[s];if(e.child[i]&&e.child[i].length>1)for(var o in n[i]=[],e.child[i])n[i].push(Ke(e.child[i][o],t));else if(!0===t.arrayMode){const r=Ke(e.child[i][0],t);n[i]="object"==typeof r?[r]:r}else"strict"===t.arrayMode?n[i]=[Ke(e.child[i][0],t)]:n[i]=Ke(e.child[i][0],t)}return n};var Qe={convertToJson:Ke},et=function(e,t,n){this.tagname=e,this.parent=t,this.child={},this.attrsMap={},this.val=n,this.addChild=function(e){Array.isArray(this.child[e.tagname])?this.child[e.tagname].push(e):this.child[e.tagname]=[e]}};const tt=Ze.buildOptions;"<((!\\[CDATA\\[([\\s\\S]*?)(]]>))|((NAME:)?(NAME))([^>]*)>|((\\/)(NAME)\\s*>))([^<]*)".replace(/NAME/g,Ze.nameRegexp);!Number.parseInt&&window.parseInt&&(Number.parseInt=window.parseInt),!Number.parseFloat&&window.parseFloat&&(Number.parseFloat=window.parseFloat);const nt={attributeNamePrefix:"@_",attrNodeName:!1,textNodeName:"#text",ignoreAttributes:!0,ignoreNameSpace:!1,allowBooleanAttributes:!1,parseNodeValue:!0,parseAttributeValue:!1,arrayMode:!1,trimValues:!0,cdataTagName:!1,cdataPositionChar:"\\c",tagValueProcessor:function(e,t){return e},attrValueProcessor:function(e,t){return e},stopNodes:[]};var rt=nt;const it=["attributeNamePrefix","attrNodeName","textNodeName","ignoreAttributes","ignoreNameSpace","allowBooleanAttributes","parseNodeValue","parseAttributeValue","arrayMode","trimValues","cdataTagName","cdataPositionChar","tagValueProcessor","attrValueProcessor","parseTrueNumberOnly","stopNodes"];var ot=it;function st(e,t,n){return t&&(n.trimValues&&(t=t.trim()),t=lt(t=n.tagValueProcessor(t,e),n.parseNodeValue,n.parseTrueNumberOnly)),t}function at(e,t){if(t.ignoreNameSpace){const t=e.split(":"),n="/"===e.charAt(0)?"/":"";if("xmlns"===t[0])return"";2===t.length&&(e=n+t[1])}return e}function lt(e,t,n){if(t&&"string"==typeof e){let t;return""===e.trim()||isNaN(e)?t="true"===e||"false"!==e&&e:(-1!==e.indexOf("0x")?t=Number.parseInt(e,16):-1!==e.indexOf(".")?(t=Number.parseFloat(e),e=e.replace(/\.?0+$/,"")):t=Number.parseInt(e,10),n&&(t=String(t)===e?t:e)),t}return Ze.isExist(e)?e:""}const ct=new RegExp("([^\\s=]+)\\s*(=\\s*(['\"])(.*?)\\3)?","g");function ut(e,t){if(!t.ignoreAttributes&&"string"==typeof e){e=e.replace(/\r?\n/g," ");const n=Ze.getAllMatches(e,ct),r=n.length,i={};for(let e=0;e<r;e++){const r=at(n[e][1],t);r.length&&(void 0!==n[e][4]?(t.trimValues&&(n[e][4]=n[e][4].trim()),n[e][4]=t.attrValueProcessor(n[e][4],r),i[t.attributeNamePrefix+r]=lt(n[e][4],t.parseAttributeValue,t.parseTrueNumberOnly)):t.allowBooleanAttributes&&(i[t.attributeNamePrefix+r]=!0))}if(!Object.keys(i).length)return;if(t.attrNodeName){const e={};return e[t.attrNodeName]=i,e}return i}}function dt(e,t){let n,r="";for(let i=t;i<e.length;i++){let t=e[i];if(n)t===n&&(n="");else if('"'===t||"'"===t)n=t;else{if(">"===t)return{data:r,index:i};"\t"===t&&(t=" ")}r+=t}}function ft(e,t,n,r){const i=e.indexOf(t,n);if(-1===i)throw new Error(r);return i+t.length-1}var ht={defaultOptions:rt,props:ot,getTraversalObj:function(e,t){e=e.replace(/(\r\n)|\n/," "),t=tt(t,nt,it);const n=new et("!xml");let r=n,i="";for(let n=0;n<e.length;n++){if("<"===e[n])if("/"===e[n+1]){const o=ft(e,">",n,"Closing Tag is not closed.");let s=e.substring(n+2,o).trim();if(t.ignoreNameSpace){const e=s.indexOf(":");-1!==e&&(s=s.substr(e+1))}r&&(r.val?r.val=Ze.getValue(r.val)+""+st(s,i,t):r.val=st(s,i,t)),t.stopNodes.length&&t.stopNodes.includes(r.tagname)&&(r.child=[],null==r.attrsMap&&(r.attrsMap={}),r.val=e.substr(r.startIndex+1,n-r.startIndex-1)),r=r.parent,i="",n=o}else if("?"===e[n+1])n=ft(e,"?>",n,"Pi Tag is not closed.");else if("!--"===e.substr(n+1,3))n=ft(e,"--\x3e",n,"Comment is not closed.");else if("!D"===e.substr(n+1,2)){const t=ft(e,">",n,"DOCTYPE is not closed.");n=e.substring(n,t).indexOf("[")>=0?e.indexOf("]>",n)+1:t}else if("!["===e.substr(n+1,2)){const o=ft(e,"]]>",n,"CDATA is not closed.")-2,s=e.substring(n+9,o);if(i&&(r.val=Ze.getValue(r.val)+""+st(r.tagname,i,t),i=""),t.cdataTagName){const e=new et(t.cdataTagName,r,s);r.addChild(e),r.val=Ze.getValue(r.val)+t.cdataPositionChar,s&&(e.val=s)}else r.val=(r.val||"")+(s||"");n=o+2}else{const o=dt(e,n+1);let s=o.data;const a=o.index,l=s.indexOf(" ");let c=s;if(-1!==l&&(c=s.substr(0,l).trimRight(),s=s.substr(l+1)),t.ignoreNameSpace){const e=c.indexOf(":");-1!==e&&(c=c.substr(e+1))}if(r&&i&&"!xml"!==r.tagname&&(r.val=Ze.getValue(r.val)+""+st(r.tagname,i,t)),s.length>0&&s.lastIndexOf("/")===s.length-1){"/"===c[c.length-1]?(c=c.substr(0,c.length-1),s=c):s=s.substr(0,s.length-1);const e=new et(c,r,"");c!==s&&(e.attrsMap=ut(s,t)),r.addChild(e)}else{const e=new et(c,r);t.stopNodes.length&&t.stopNodes.includes(e.tagname)&&(e.startIndex=a),c!==s&&(e.attrsMap=ut(s,t)),r.addChild(e),r=e}i="",n=a}else i+=e[n]}return n}};const pt={allowBooleanAttributes:!1},gt=["allowBooleanAttributes"];function yt(e,t){for(var n=t;t<e.length;t++)if("?"!=e[t]&&" "!=e[t]);else{var r=e.substr(n,t-n);if(t>5&&"xml"===r)return At("InvalidXml","XML declaration allowed only at the start of the document.",Nt(e,t));if("?"==e[t]&&">"==e[t+1]){t++;break}}return t}function vt(e,t){if(e.length>t+5&&"-"===e[t+1]&&"-"===e[t+2]){for(t+=3;t<e.length;t++)if("-"===e[t]&&"-"===e[t+1]&&">"===e[t+2]){t+=2;break}}else if(e.length>t+8&&"D"===e[t+1]&&"O"===e[t+2]&&"C"===e[t+3]&&"T"===e[t+4]&&"Y"===e[t+5]&&"P"===e[t+6]&&"E"===e[t+7]){let n=1;for(t+=8;t<e.length;t++)if("<"===e[t])n++;else if(">"===e[t]&&(n--,0===n))break}else if(e.length>t+9&&"["===e[t+1]&&"C"===e[t+2]&&"D"===e[t+3]&&"A"===e[t+4]&&"T"===e[t+5]&&"A"===e[t+6]&&"["===e[t+7])for(t+=8;t<e.length;t++)if("]"===e[t]&&"]"===e[t+1]&&">"===e[t+2]){t+=2;break}return t}function mt(e,t){let n="",r="",i=!1;for(;t<e.length;t++){if('"'===e[t]||"'"===e[t])if(""===r)r=e[t];else{if(r!==e[t])continue;r=""}else if(">"===e[t]&&""===r){i=!0;break}n+=e[t]}return""===r&&{value:n,index:t,tagClosed:i}}const bt=new RegExp("(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['\"])(([\\s\\S])*?)\\5)?","g");function wt(e,t){const n=Ze.getAllMatches(e,bt),r={};for(let i=0;i<n.length;i++){if(0===n[i][1].length)return At("InvalidAttr","Attribute '"+n[i][2]+"' has no space in starting.",Ot(e,n[i][0]));if(void 0===n[i][3]&&!t.allowBooleanAttributes)return At("InvalidAttr","boolean attribute '"+n[i][2]+"' is not allowed.",Ot(e,n[i][0]));const o=n[i][2];if(!Pt(o))return At("InvalidAttr","Attribute '"+o+"' is an invalid name.",Ot(e,n[i][0]));if(r.hasOwnProperty(o))return At("InvalidAttr","Attribute '"+o+"' is repeated.",Ot(e,n[i][0]));r[o]=1}return!0}function xt(e,t){if(";"===e[++t])return-1;if("#"===e[t])return function(e,t){let n=/\d/;for("x"===e[t]&&(t++,n=/[\da-fA-F]/);t<e.length;t++){if(";"===e[t])return t;if(!e[t].match(n))break}return-1}(e,++t);let n=0;for(;t<e.length;t++,n++)if(!(e[t].match(/\w/)&&n<20)){if(";"===e[t])break;return-1}return t}function At(e,t,n){return{err:{code:e,msg:t,line:n}}}function Pt(e){return Ze.isName(e)}function Nt(e,t){return e.substring(0,t).split(/\r?\n/).length}function Ot(e,t){return e.indexOf(t)+t.length}var Ct=function(e,t){t=Ze.buildOptions(t,pt,gt);const n=[];let r=!1,i=!1;"\ufeff"===e[0]&&(e=e.substr(1));for(let s=0;s<e.length;s++){if("<"!==e[s]){if(" "===e[s]||"\t"===e[s]||"\n"===e[s]||"\r"===e[s])continue;return At("InvalidChar","char '"+e[s]+"' is not expected.",Nt(e,s))}if(s++,"?"===e[s]){if(s=yt(e,++s),s.err)return s}else{if("!"===e[s]){s=vt(e,s);continue}{let a=!1;"/"===e[s]&&(a=!0,s++);let l="";for(;s<e.length&&">"!==e[s]&&" "!==e[s]&&"\t"!==e[s]&&"\n"!==e[s]&&"\r"!==e[s];s++)l+=e[s];if(l=l.trim(),"/"===l[l.length-1]&&(l=l.substring(0,l.length-1),s--),o=l,!Ze.isName(o)){let t;return t=0===l.trim().length?"There is an unnecessary space between tag name and backward slash '</ ..'.":"Tag '"+l+"' is an invalid name.",At("InvalidTag",t,Nt(e,s))}const c=mt(e,s);if(!1===c)return At("InvalidAttr","Attributes for '"+l+"' have open quote.",Nt(e,s));let u=c.value;if(s=c.index,"/"===u[u.length-1]){u=u.substring(0,u.length-1);const n=wt(u,t);if(!0!==n)return At(n.err.code,n.err.msg,Nt(e,s-u.length+n.err.line));r=!0}else if(a){if(!c.tagClosed)return At("InvalidTag","Closing tag '"+l+"' doesn't have proper closing.",Nt(e,s));if(u.trim().length>0)return At("InvalidTag","Closing tag '"+l+"' can't have attributes or invalid starting.",Nt(e,s));{const t=n.pop();if(l!==t)return At("InvalidTag","Closing tag '"+t+"' is expected inplace of '"+l+"'.",Nt(e,s));0==n.length&&(i=!0)}}else{const o=wt(u,t);if(!0!==o)return At(o.err.code,o.err.msg,Nt(e,s-u.length+o.err.line));if(!0===i)return At("InvalidXml","Multiple possible root nodes found.",Nt(e,s));n.push(l),r=!0}for(s++;s<e.length;s++){if("<"===e[s]){if("!"===e[s+1]){s++,s=vt(e,s);continue}break}if("&"===e[s]){const t=xt(e,s);if(-1==t)return At("InvalidChar","char '&' is not expected.",Nt(e,s));s=t}}"<"===e[s]&&s--}}}var o;return r?!(n.length>0)||At("InvalidXml","Invalid '"+JSON.stringify(n,null,4).replace(/\r?\n/g,"")+"' found.",1):At("InvalidXml","Start tag expected.",1)};const jt=function(e){return String.fromCharCode(e)},Tt={nilChar:jt(176),missingChar:jt(201),nilPremitive:jt(175),missingPremitive:jt(200),emptyChar:jt(178),emptyValue:jt(177),boundryChar:jt(179),objStart:jt(198),arrStart:jt(204),arrayEnd:jt(185)},kt=[Tt.nilChar,Tt.nilPremitive,Tt.missingChar,Tt.missingPremitive,Tt.boundryChar,Tt.emptyChar,Tt.emptyValue,Tt.arrayEnd,Tt.objStart,Tt.arrStart],St=function(e,t,n){if("string"==typeof t)return e&&e[0]&&void 0!==e[0].val?Et(e[0].val):Et(e);{const i=void 0===(r=e)?Tt.missingChar:null===r?Tt.nilChar:!(r.child&&0===Object.keys(r.child).length&&(!r.attrsMap||0===Object.keys(r.attrsMap).length))||Tt.emptyChar;if(!0===i){let r="";if(Array.isArray(t)){r+=Tt.arrStart;const i=t[0],o=e.length;if("string"==typeof i)for(let t=0;t<o;t++){const n=Et(e[t].val);r=It(r,n)}else for(let t=0;t<o;t++){const o=St(e[t],i,n);r=It(r,o)}r+=Tt.arrayEnd}else{r+=Tt.objStart;const i=Object.keys(t);Array.isArray(e)&&(e=e[0]);for(let o in i){const s=i[o];let a;a=!n.ignoreAttributes&&e.attrsMap&&e.attrsMap[s]?St(e.attrsMap[s],t[s],n):s===n.textNodeName?St(e.val,t[s],n):St(e.child[s],t[s],n),r=It(r,a)}}return r}return i}var r},Et=function(e){switch(e){case void 0:return Tt.missingPremitive;case null:return Tt.nilPremitive;case"":return Tt.emptyValue;default:return e}},It=function(e,t){return _t(t[0])||_t(e[e.length-1])||(e+=Tt.boundryChar),e+t},_t=function(e){return-1!==kt.indexOf(e)};const Vt=Ze.buildOptions;var Ft={convert2nimn:function(e,t,n){return n=Vt(n,ht.defaultOptions,ht.props),St(e,t,n)}};const Mt=Ze.buildOptions,Dt=function(e,t,n){let r="{";const i=Object.keys(e.child);for(let n=0;n<i.length;n++){var o=i[n];if(e.child[o]&&e.child[o].length>1){for(var s in r+='"'+o+'" : [ ',e.child[o])r+=Dt(e.child[o][s],t)+" , ";r=r.substr(0,r.length-1)+" ] "}else r+='"'+o+'" : '+Dt(e.child[o][0],t)+" ,"}return Ze.merge(r,e.attrsMap),Ze.isEmptyObject(r)?Ze.isExist(e.val)?e.val:"":(Ze.isExist(e.val)&&("string"!=typeof e.val||""!==e.val&&e.val!==t.cdataPositionChar)&&(r+='"'+t.textNodeName+'" : '+(!0!==(a=e.val)&&!1!==a&&isNaN(a)?'"'+a+'"':a)),","===r[r.length-1]&&(r=r.substr(0,r.length-2)),r+"}");var a};var Rt={convertToJsonString:function(e,t){return(t=Mt(t,ht.defaultOptions,ht.props)).indentBy=t.indentBy||"",Dt(e,t)}};const $t=Ze.buildOptions,Gt={attributeNamePrefix:"@_",attrNodeName:!1,textNodeName:"#text",ignoreAttributes:!0,cdataTagName:!1,cdataPositionChar:"\\c",format:!1,indentBy:"  ",supressEmptyNode:!1,tagValueProcessor:function(e){return e},attrValueProcessor:function(e){return e}},Lt=["attributeNamePrefix","attrNodeName","textNodeName","ignoreAttributes","cdataTagName","cdataPositionChar","format","indentBy","supressEmptyNode","tagValueProcessor","attrValueProcessor"];function Bt(e){this.options=$t(e,Gt,Lt),this.options.ignoreAttributes||this.options.attrNodeName?this.isAttribute=function(){return!1}:(this.attrPrefixLen=this.options.attributeNamePrefix.length,this.isAttribute=Yt),this.options.cdataTagName?this.isCDATA=Zt:this.isCDATA=function(){return!1},this.replaceCDATAstr=Jt,this.replaceCDATAarr=zt,this.options.format?(this.indentate=Ht,this.tagEndChar=">\n",this.newLine="\n"):(this.indentate=function(){return""},this.tagEndChar=">",this.newLine=""),this.options.supressEmptyNode?(this.buildTextNode=qt,this.buildObjNode=Xt):(this.buildTextNode=Wt,this.buildObjNode=Ut),this.buildTextValNode=Wt,this.buildObjectNode=Ut}function Jt(e,t){return e=this.options.tagValueProcessor(""+e),""===this.options.cdataPositionChar||""===e?e+"<![CDATA["+t+"]]"+this.tagEndChar:e.replace(this.options.cdataPositionChar,"<![CDATA["+t+"]]"+this.tagEndChar)}function zt(e,t){if(e=this.options.tagValueProcessor(""+e),""===this.options.cdataPositionChar||""===e)return e+"<![CDATA["+t.join("]]><![CDATA[")+"]]"+this.tagEndChar;for(let n in t)e=e.replace(this.options.cdataPositionChar,"<![CDATA["+t[n]+"]]>");return e+this.newLine}function Ut(e,t,n,r){return n&&!e.includes("<")?this.indentate(r)+"<"+t+n+">"+e+"</"+t+this.tagEndChar:this.indentate(r)+"<"+t+n+this.tagEndChar+e+this.indentate(r)+"</"+t+this.tagEndChar}function Xt(e,t,n,r){return""!==e?this.buildObjectNode(e,t,n,r):this.indentate(r)+"<"+t+n+"/"+this.tagEndChar}function Wt(e,t,n,r){return this.indentate(r)+"<"+t+n+">"+this.options.tagValueProcessor(e)+"</"+t+this.tagEndChar}function qt(e,t,n,r){return""!==e?this.buildTextValNode(e,t,n,r):this.indentate(r)+"<"+t+n+"/"+this.tagEndChar}function Ht(e){return this.options.indentBy.repeat(e)}function Yt(e){return!!e.startsWith(this.options.attributeNamePrefix)&&e.substr(this.attrPrefixLen)}function Zt(e){return e===this.options.cdataTagName}Bt.prototype.parse=function(e){return this.j2x(e,0).val},Bt.prototype.j2x=function(e,t){let n="",r="";const i=Object.keys(e),o=i.length;for(let s=0;s<o;s++){const o=i[s];if(void 0===e[o]);else if(null===e[o])r+=this.indentate(t)+"<"+o+"/"+this.tagEndChar;else if(e[o]instanceof Date)r+=this.buildTextNode(e[o],o,"",t);else if("object"!=typeof e[o]){const i=this.isAttribute(o);i?n+=" "+i+'="'+this.options.attrValueProcessor(""+e[o])+'"':this.isCDATA(o)?e[this.options.textNodeName]?r+=this.replaceCDATAstr(e[this.options.textNodeName],e[o]):r+=this.replaceCDATAstr("",e[o]):o===this.options.textNodeName?e[this.options.cdataTagName]||(r+=this.options.tagValueProcessor(""+e[o])):r+=this.buildTextNode(e[o],o,"",t)}else if(Array.isArray(e[o]))if(this.isCDATA(o))r+=this.indentate(t),e[this.options.textNodeName]?r+=this.replaceCDATAarr(e[this.options.textNodeName],e[o]):r+=this.replaceCDATAarr("",e[o]);else{const n=e[o].length;for(let i=0;i<n;i++){const n=e[o][i];if(void 0===n);else if(null===n)r+=this.indentate(t)+"<"+o+"/"+this.tagEndChar;else if("object"==typeof n){const e=this.j2x(n,t+1);r+=this.buildObjNode(e.val,o,e.attrStr,t)}else r+=this.buildTextNode(n,o,"",t)}}else if(this.options.attrNodeName&&o===this.options.attrNodeName){const t=Object.keys(e[o]),r=t.length;for(let i=0;i<r;i++)n+=" "+t[i]+'="'+this.options.attrValueProcessor(""+e[o][t[i]])+'"'}else{const n=this.j2x(e[o],t+1);r+=this.buildObjNode(n.val,o,n.attrStr,t)}}return{attrStr:n,val:r}};var Kt=Bt,Qt=Ye((function(e,t){const n=ht,r=Ze.buildOptions;t.parse=function(e,t,i){if(i){!0===i&&(i={});const t=Ct(e,i);if(!0!==t)throw Error(t.err.msg)}t=r(t,n.defaultOptions,n.props);const o=ht.getTraversalObj(e,t);return Qe.convertToJson(o,t)},t.convertTonimn=Ft.convert2nimn,t.getTraversalObj=ht.getTraversalObj,t.convertToJson=Qe.convertToJson,t.convertToJsonString=Rt.convertToJsonString,t.validate=Ct,t.j2xParser=Kt,t.parseToNimn=function(e,n,r){return t.convertTonimn(t.getTraversalObj(e,r),n,r)}}));Qt.parse,Qt.convertTonimn,Qt.getTraversalObj,Qt.convertToJson,Qt.convertToJsonString,Qt.validate,Qt.j2xParser,Qt.parseToNimn;class en extends Error{constructor(e=""){super("Cannot assign value to a read-only property. "+e),Object.setPrototypeOf(this,new.target.prototype)}}class tn extends Error{constructor(e=""){super("Cannot read value on a write-only property. "+e),Object.setPrototypeOf(this,new.target.prototype)}}class nn extends Error{constructor(e=""){let t="Invalid Parameters";e&&(t+=": "+e),super(t),Object.setPrototypeOf(this,new.target.prototype)}}class rn extends Error{constructor(e){let t="Not supported on "+(["Source Plugins","Source Property","Extensions"][[f.isSourcePlugin,f.isSourceProps,f.isExtension].indexOf(!0)]||"current environment");e&&(t+=": "+e),super(t),Object.setPrototypeOf(this,new.target.prototype)}}const on=t=>e(void 0,void 0,void 0,(function*(){return Boolean(Number(yield t.exec("GetGlobalProperty","splitmode")))}));var sn,an,ln=(sn={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},function(e){return null==sn?void 0:sn[e]}),cn=/&(?:amp|lt|gt|quot|#39);/g,un=RegExp(cn.source);function dn(e="embedded"){if("undefined"==typeof window)return;const t={event:"set-mode",value:e};window.parent.postMessage(JSON.stringify(t),"*")}function fn(e){if("undefined"==typeof window)return;const t={event:"set-custom-tabs",value:JSON.stringify(e)};window.parent.postMessage(JSON.stringify(t),"*")}function hn(e){if("undefined"==typeof window)return;const t={event:"set-tab-order",value:JSON.stringify(e)};window.parent.postMessage(JSON.stringify(t),"*")}function pn(e){if("undefined"==typeof window)return;const t={event:"show-overlay",value:!e};window.parent.postMessage(JSON.stringify(t),"*")}!function(e){e.FULL="full",e.TABBED="embedded"}(an||(an={}));const gn={};"undefined"!=typeof window&&void 0===window.OnPropsMessageReceive&&(window.OnPropsMessageReceive=e=>{try{const{key:t,payload:n}=JSON.parse(e);if(void 0===gn[t])return;gn[t].forEach(e=>{"function"==typeof e&&e(n)})}catch(e){console.error("OnPropsMessageReceive is invalid",e.message)}});const yn={configure:function(e){dn(e.mode),fn(e.customTabs),hn(e.tabOrder),pn(!0)},resize:function(e,t){if("undefined"==typeof window)return;const n={event:"resize",value:JSON.stringify({width:e,height:t})};window.parent.postMessage(JSON.stringify(n),"*")},setCustomTabs:fn,setMode:dn,setTabsOrder:hn,setVisible:pn,emit:function(e,t){if("undefined"==typeof window)return;window.external.CallInner("OnPropsMessageReceive",JSON.stringify({key:e,payload:t}))},on:function(e,t){void 0===gn[e]&&(gn[e]=[]),gn[e].push(t)},off:(e,t)=>{if(void 0===gn[e])return;const n=gn[e].indexOf(t);-1!==n&&delete gn[e][n]}};function vn(e,t){if("object"!=typeof e)return[!1,t];const n=Object.keys(e),r=t.filter(e=>-1===n.indexOf(e));return r.length>0?[!1,r]:[!0,[]]}const mn={keepAspectRatio:{key:"prop:keep_ar",setValidator:e=>{if("boolean"!=typeof e)throw new nn(e+" should be a boolean");return!0},setTransformer:e=>e?"1":"0",getTransformer:e=>"1"===e},transparency:{key:"prop:alpha",setValidator:e=>{if("number"!=typeof e)throw new nn(e+" should be a number");if(e<0||e>255)throw new Error("Transparency may only be in the range 0-255.");return!0},setTransformer:e=>String(e),getTransformer:e=>parseInt(e)},browser60fps:{key:"prop:Browser60fps",setValidator:e=>{if("boolean"!=typeof e)throw new nn(e+" should be a boolean");return!0},setTransformer:e=>e?"1":"0",getTransformer:e=>"1"===e},customName:{key:"prop:cname",setValidator:e=>{if("string"!=typeof e)throw new nn(e+" should be a string");return!0}},position:{key:"prop:pos",setValidator:e=>{const[t,n]=vn(e,["left","top","right","bottom"]);if(t)throw new nn("Missing keys: "+n.join(", "));return!0},setTransformer:e=>{const t=Object.keys(e).reduce((t,n)=>{const r=Number(e[n])/100;return Object.assign(Object.assign({},t),{[n]:Math.min(Math.max(0,r),1).toFixed(1)})},{});return`${t.left},${t.top},${t.right},${t.bottom}`},getTransformer:e=>{const t=String(e).split(","),n=["left","top","right","bottom"];return t.reduce((e,t,r)=>Object.assign(Object.assign({},e),{[n[r]]:100*Number(t)}),{})}},visibility:{key:"prop:visible",setValidator:e=>{if(e)throw new nn(e+" should be a boolean");return!0},setTransformer:e=>e?"1":"0",getTransformer:e=>"1"===e},item:{key:"prop:item"},srcid:{key:"prop:srcid"},type:{key:"prop:type",setValidator:e=>{const[t,n]=vn(e,["type","item"]);if(t)throw new nn("Missing keys: "+n.join(", "));return!0},setTransformer:e=>`${e.type},${e.item}`,getTransformer:e=>({0:"undefined",1:"file",2:"live",3:"text",4:"bitmap",5:"screen",6:"flash",7:"games",8:"html",9:"3ds",10:"ppt",11:"scene",12:"group",13:"replay"}[e])},itemList:{key:"itemlist",setValidator:()=>{throw new en("Setting itemlist is not supported")},setTransformer:()=>{throw new en("Setting itemlist is not supported")},getTransformer:e=>String(e).split(",")},fileInfo:{key:"FileInfo",setValidator:()=>{throw new en("Setting FileInfo is not supported")}}},bn={scenes:{key:"sceneconfig",setValidator:e=>{if("string"!=typeof e)throw new Error("Parameter should be a string");return!0}},sceneIndex:{key:"scene:${view}",setValidator:e=>{const[t,n]=vn(e,["value","view"]);if(!t)throw new nn("Missing keys: "+n.join(", "));return!0},setTransformer:e=>String(e.value),getValidator:e=>{const[t,n]=vn(e,["view"]);if(!t)throw new nn("Missing keys: "+n.join(", "));return!0},getTransformer:e=>Number(e)},scenePreset:{key:"scenepreset:${scene}",setValidator:e=>{const[t,n]=vn(e,["value","scene"]);if(!t)throw new nn("Missing keys: "+n.join(", "));if(f.isSourcePlugin)throw new rn;return!0},setTransformer:e=>e.value,getValidator:e=>{const[t,n]=vn(e,["scene"]);if(!t)throw new nn("Missing keys: "+n.join(", "));if(f.isSourcePlugin)throw new rn;return!0}},scenePresetList:{key:"scenepresetlist:${scene}",setValidator:()=>{throw new en},getValidator:e=>{const[t,n]=vn(e,["scene"]);if(!t)throw new nn("Missing keys: "+n.join(", "));if(f.isSourcePlugin)throw new rn;return!0},getTransformer:e=>["{00000000-0000-0000-0000-000000000000}",...String(e).split(",").filter(Boolean)]},sceneNewPreset:{key:"scenenewpreset:${scene}",setValidator:()=>{throw new en},getValidator:e=>{const[t,n]=vn(e,["scene"]);if(!t)throw new nn("Missing keys: "+n.join(", "));if(f.isSourcePlugin)throw new rn;return!0}},sceneRemovePreset:{key:"sceneremovepreset:${scene}",setValidator:e=>{const[t,n]=vn(e,["scene","value"]);if(!t)throw new nn("Missing keys: "+n.join(", "));if(f.isSourcePlugin)throw new rn;return!0},setTransformer:e=>e.value,getValidator:()=>{throw new tn}},scenePresetTransition:{key:"scenepresettransitionfunc:${scene}",setValidator:e=>{const[t,n]=vn(e,["scene","value"]);if(!t)throw new nn("Missing keys: "+n.join(", "));if(f.isSourcePlugin)throw new rn;return!0},setTransformer:e=>"none"===e.value?"":e.value,getValidator:e=>{const[t,n]=vn(e,["scene"]);if(!t)throw new nn("Missing keys: "+n.join(", "));if(f.isSourcePlugin)throw new rn;return!0},getTransformer:e=>""===e?"none":e},scenePresetTransitionTime:{key:"scenepresettransitiontime:${scene}",setValidator:e=>{const[t,n]=vn(e,["scene","value"]);if(!t)throw new nn("Missing keys: "+n.join(", "));if(f.isSourcePlugin)throw new rn;return!0},setTransformer:e=>String(e.value),getValidator:e=>{const[t,n]=vn(e,["scene","value"]);if(!t)throw new nn("Missing keys: "+n.join(", "));if(f.isSourcePlugin)throw new rn;return!0},getTransformer:e=>Number(e)},microphoneDev2:{key:"microphonedev2",setValidator:e=>{if("string"!=typeof e)throw new Error("Parameter should be a string");return!0}},wasapiEnum:{key:"wasapienum",setValidator:e=>{if("string"!=typeof e)throw new Error("Parameter should be a string");return!0}},sceneItems:{key:"sceneconfig:${scene}",setValidator:e=>{const[t,n]=vn(e,["scene","value"]);if(!t)throw new nn("Missing keys: "+n.join(", "));return!0},setTransformer:e=>e.value,getValidator:e=>{const[t,n]=vn(e,["scene"]);if(!t)throw new nn("Missing keys: "+n.join(", "));return!0}},sceneName:{key:"scenename:${scene}",setValidator:e=>{const[t,n]=vn(e,["value","scene"]);if(!t)throw new nn("Missing keys: "+n.join(", "));return!0},setTransformer:e=>e.value,getValidator:e=>{const[t,n]=vn(e,["scene"]);if(!t)throw new nn("Missing keys: "+n.join(", "));return!0}},sceneThumbnail:{key:"sceneshot:${scene}:${width},${height}",setValidator:()=>{throw new en},getValidator:e=>{const[t,n]=vn(e,["scene","width","height"]);if(!t)throw new nn("Missing keys: "+n.join(", "));return!0}},audioDevices:{},audioDevicesWASAPI:{}};bn.audioDevices=bn.microphoneDev2,bn.audioDevicesWASAPI=bn.wasapiEnum;class wn{constructor(e){return new We(e)}}return wn.XjsTypes=s,wn.App=class{constructor(e){this.internal=e.internal}setProperty(e,t){if("function"!=typeof e.setValidator||e.setValidator(t)){let n=e.key,r=t;if("object"==typeof t){const i=Object.assign({},t);n=qe(e.key,i,!0),r="function"==typeof e.setTransformer?e.setTransformer(i):String(i.value)}else r="function"==typeof e.setTransformer?e.setTransformer(t):String(t);return this.internal.exec("AppSetPropertyAsync",n,r)}throw new Error(`Params "${t}" validation failed`)}getProperty(t,n){return e(this,void 0,void 0,(function*(){if("function"!=typeof t.getValidator||t.getValidator(n)){const e=qe(t.key,n||{}),r=yield this.internal.exec("AppGetPropertyAsync",e);return"function"==typeof t.getTransformer?t.getTransformer(r):r}throw new Error(`Params "${n}" validation failed`)}))}},wn.Events=class{constructor(t,n){this.callbacks={},this.xjs=t,this.instances=n||[],Ue({SetEvent:t=>e(this,void 0,void 0,(function*(){const{event:n,info:r}=t.split("&").reduce((e,t)=>{const[n,r]=t.split("=");return Object.assign(Object.assign({},e),{[n]:r})},{});const i=yield He(this.instances,(t,i)=>e(this,void 0,void 0,(function*(){return t!==r?t:"function"==typeof i.eventsHandler?i.eventsHandler(n,r):r})),r);Array.isArray(this.callbacks[n])&&this.callbacks[n].forEach(e=>{"function"==typeof e&&e(decodeURIComponent(i))})})),AppOnEvent:(t,...n)=>e(this,void 0,void 0,(function*(){const r=yield He(this.instances,(t,r)=>e(this,void 0,void 0,(function*(){return"function"==typeof r.eventsHandler?r.eventsHandler(event,...n):t})));Array.isArray(this.callbacks[t])&&this.callbacks[t].forEach(e=>{if("function"==typeof e){e(...r?[r]:n)}})}))})}on(e,t){this.callbacks[e]=this.callbacks[e]?[...this.callbacks[e],t]:[t]}off(e){delete this.callbacks[e]}},wn.Item=class{constructor(e){this.internal=e.internal}getPlacements(){return e(this,void 0,void 0,(function*(){const e=yield this.internal.exec("AppGetPropertyAsync","sceneconfig"),t=Qt.parse(e,{attributeNamePrefix:"",ignoreAttributes:!1});return t&&t.configuration&&t.configuration.placement||[]}))}getLinkedItem(t){return e(this,void 0,void 0,(function*(){const e=yield this.getItemList(t);return e.length>0?e[0]:""}))}getItemList(t){return e(this,void 0,void 0,(function*(){return(yield this.getPlacements()).reduce((e,n)=>{const r=n.item||[];return[...e,...(Array.isArray(r)?r:[r]).filter(e=>e.srcid===t).map(e=>e.id)]},[])}))}getCurrentItem(){return e(this,void 0,void 0,(function*(){if(f.isExtension)throw new Error("You cannot use `getCurrentItem` in an extension plugin");const e=yield this.internal.exec("GetLocalPropertyAsync","itemlist"),t=yield this.internal.exec("GetLocalPropertyAsync","prop:srcid"),n=e.split(",");if(0===n.length)throw new Error("Cannot get current item, itemlist did not return any ID");return{srcId:t,id:n[0]}}))}setProperty(t,n){return e(this,void 0,void 0,(function*(){if(void 0===n.id||void 0===n.srcId)throw new nn("param should be an object with an `id` and `srcid` property");if("function"!=typeof t.setValidator||t.setValidator(n.value)){const e=f.isSourcePlugin?"AttachVideoItem1":"SearchVideoItem",r=f.isSourcePlugin?"SetLocalPropertyAsync1":"SetLocalPropertyAsync";this.internal.exec(e,n.id);const i=yield this.internal.exec(r,t.key,"function"!=typeof t.setTransformer?n.value:t.setTransformer(n.value));if(isNaN(i)||!(Number(i)<0))return i;{console.warn("Attached item does not exist. Attempting to attach linked item...");const e=yield this.getLinkedItem(n.srcId);if(e)return this.setProperty(t,Object.assign(Object.assign({},n),{id:e}));console.error("Failed to find linked item.")}}throw new nn(`Params "${n}" validation failed`)}))}getProperty(t,n){return e(this,void 0,void 0,(function*(){if(void 0===n.id||void 0===n.srcId)throw new nn("param should be an object with an `id` and `srcid` property");if("function"!=typeof t.getValidator||t.getValidator(n.value)){const e=f.isSourcePlugin?"AttachVideoItem1":"SearchVideoItem",r=f.isSourcePlugin?"GetLocalPropertyAsync1":"GetLocalPropertyAsync";this.internal.exec(e,n.id);const i=yield this.internal.exec(r,t.key);if(null!==i&&"null"!==i)return"function"!=typeof t.getTransformer?i:t.getTransformer(i);{console.warn("Attached item does not exaist. Attempting to attach linked item...");const e=yield this.getLinkedItem(n.srcId);if(e)return this.getProperty(t,Object.assign(Object.assign({},n),{id:e}));console.error("Failed to find linked item.")}}throw new nn(`Params "${n}" validation failed`)}))}setConfiguration(t){return e(this,void 0,void 0,(function*(){if(!f.isSourcePlugin)throw new Error("You can only set configuration in source plugins");if(!this.configUrl){const e=yield this.getConfiguration();"string"!=typeof e&&(this.configUrl=e.configUrl)}"configUrl"in t||(t.configUrl=this.configUrl),this.internal.exec("SetBrowserProperty","Configuration",JSON.stringify(t))}))}getConfiguration(){return e(this,void 0,void 0,(function*(){if(f.isExtension)throw new Error("You cannot set configuration in extension plugins");let e=yield this.internal.exec("GetLocalPropertyAsync","prop:BrowserConfiguration");return e&&"null"!==e||(e=yield this.internal.exec("GetConfiguration")),JSON.parse(e||"{}")}))}},wn.Preset=class{constructor({internal:e}){this.internal=e}listAll(t){return e(this,void 0,void 0,(function*(){return["{00000000-0000-0000-0000-000000000000}",...(yield this.internal.exec("AppGetPropertyAsync","scenepresetlist:"+t)).split(",").filter(Boolean)]}))}getActive(t){return e(this,void 0,void 0,(function*(){return yield this.internal.exec("AppGetProperty","scenepreset:"+t)}))}setActive(t,n){return e(this,void 0,void 0,(function*(){return yield this.internal.exec("AppSetPropertyAsync","scenepreset:"+t,n),!0}))}},wn.Remote=Je,wn.Scene=class{constructor({internal:e}){this.internal=e}getByIndex(t){return e(this,void 0,void 0,(function*(){const e=yield this.internal.exec("AppGetPropertyAsync","sceneconfig:"+t),n=Qt.parse(e,{attributeNamePrefix:"",ignoreAttributes:!1}),{placement:r}=n;return{index:t,id:r.id,name:r.name}}))}getById(t){return e(this,void 0,void 0,(function*(){return(yield this.listAll()).find(e=>e.id===t)||Promise.reject(`Scene with id: ${t} not found`)}))}getActive(){return e(this,void 0,void 0,(function*(){if(yield on(this.internal)){const e=decodeURIComponent(yield this.internal.exec("AppGetPropertyAsync","sceneid:i12"));return this.getById(e)}const e=Number(yield this.internal.exec("AppGetPropertyAsync","scene:0"));return this.getByIndex(e)}))}setActive(t){return e(this,void 0,void 0,(function*(){return(yield on(this.internal))?(yield this.internal.exec("AppSetPropertyAsync","scene:1",String(t)),yield this.internal.exec("CallHostFunc","goLive"),!0):(yield this.internal.exec("AppSetPropertyAsync","scene:0",String(t)),!0)}))}setName(t,n){return e(this,void 0,void 0,(function*(){return yield this.internal.exec("AppSetPropertyAsync","scenename:"+t,n),!0}))}listAll(){return e(this,void 0,void 0,(function*(){const e=yield this.internal.exec("AppGetPropertyAsync","sceneconfig"),t=Qt.parse(e,{attributeNamePrefix:"",ignoreAttributes:!1}),{configuration:{placement:n}}=t;return Array.isArray(n)?n.map((e,t)=>({id:e.id,index:t,name:e.name})):"object"==typeof n?[{id:n.id,index:0,name:n.name}]:[]}))}getItems(t){return e(this,void 0,void 0,(function*(){const e=yield this.internal.exec("AppGetPropertyAsync","sceneconfig:"+t),n=Qt.parse(e,{attributeNamePrefix:"",ignoreAttributes:!1});return(Array.isArray(n.placement.item)?n.placement.item:[n.placement.item]).map(({id:e,srcid:t,name:n})=>{return{id:e,srcid:t,name:(r=n,(r=he(r))&&un.test(r)?r.replace(cn,ln):r)};var r})}))}},wn.SourcePropertyWindow=yn,wn.View=class{constructor(e){this.internal=e.internal}getCurrentSceneIndex(t){return e(this,void 0,void 0,(function*(){const e=yield this.internal.exec("AppGetPropertyAsync","scene:"+t),n=yield this.internal.exec("AppGetPropertyAsync","scene:"+e);return Number(n)}))}isSplitMode(){return e(this,void 0,void 0,(function*(){return Boolean(Number(yield this.internal.exec("GetGlobalProperty","splitmode")))}))}},wn.ItemProps=mn,wn.AppProps=bn,wn.version=We.version,wn}));
